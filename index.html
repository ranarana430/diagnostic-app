<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>〇〇診断</title>
</head>
<body>
  <h1>〇〇診断</h1>
  <div id="app">
    <p>これから10問の質問をします。</p>
    <button onclick="start()">診断スタート</button>
  </div>

  <script>
    const questions = [
      "あなたは朝型？夜型？",
      "人と話すのが好き？",
      "計画を立てるのが得意？",
      "好奇心旺盛？",
      "慎重派？それとも直感派？",
      "リーダータイプ？",
      "整理整頓が得意？",
      "一人の時間が好き？",
      "決断は早い？",
      "新しいことに挑戦するのが好き？"
    ];

    const choices = [
      { value: "A", label: "森夏華" },
      { value: "B", label: "山内春奈" },
      { value: "C", label: "荒巻宙来" },
      { value: "D", label: "谷口聖恋" },
      { value: "E", label: "三枝亜季" },
      { value: "F", label: "島田杏南" }
    ];

    let shuffled = [];
    let index = 0;
    let answers = [];

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function start() {
      shuffled = shuffle([...questions]);
      index = 0;
      answers = [];
      showQuestion();
    }

    function showQuestion() {
      const q = shuffled[index];
      let html = `<h2>Q${index + 1}: ${q}</h2><form id="form">`;

      choices.forEach(c => {
        html += `
          <label>
            <input type="radio" name="answer" value="${c.value}"> ${c.label}
          </label><br>`;
      });

      html += `</form><br><button onclick="next()">次へ</button>`;
      document.getElementById('app').innerHTML = html;
    }

    function next() {
      const form = document.getElementById('form');
      const data = new FormData(form);
      const selected = data.get("answer");

      if (!selected) {
        alert("選択肢を1つ選んでください！");
        return;
      }

      answers.push(selected);
      index++;

      if (index < shuffled.length) {
        showQuestion();
      } else {
        showResult();
      }
    }

    function showResult() {
      const count = {};
      answers.forEach(a => count[a] = (count[a] || 0) + 1);
      const sorted = Object.entries(count).sort((a, b) => b[1] - a[1]);
      const resultValue = sorted[0][0];
      const resultLabel = choices.find(c => c.value === resultValue)?.label || "不明";

      document.getElementById('app').innerHTML = `
        <h2>診断結果</h2>
        <p>あなたのタイプは「${resultLabel}」です！</p>
        <br>
        <button onclick="showTop()">もう一度遊ぶ</button>
      `;
    }

    function showTop() {
      document.getElementById('app').innerHTML = `
        <p>これから10問の質問をします。</p>
        <button onclick="start()">診断スタート</button>
      `;
    }
  </script>
</body>
</html>
